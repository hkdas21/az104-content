<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ-104 Exam Prep Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .flashcard-container { perspective: 1000px; height: 220px; }
        .flashcard-inner { 
            position: relative; 
            width: 100%; 
            height: 100%; 
            text-align: center; 
            transition: transform 0.6s; 
            transform-style: preserve-3d; 
            cursor: pointer;
        }
        .flashcard-container.flipped .flashcard-inner { transform: rotateY(180deg); }
        .flashcard-front, .flashcard-back { 
            position: absolute; 
            width: 100%; 
            height: 100%; 
            backface-visibility: hidden; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 1.5rem; 
            border-radius: 1rem; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
        }
        .flashcard-back { transform: rotateY(180deg); }
        
        .view-content { display: none; }
        .view-content.active { display: block; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .donut-ring { transition: stroke-dashoffset 0.5s ease; transform: rotate(-90deg); transform-origin: 50% 50%; }
        
        .module-card:hover { transform: translateY(-4px); transition: all 0.2s ease; }

        /* Quiz Feedback Styles */
        .option-btn.correct { @apply border-green-500 bg-green-50 text-green-700 ring-2 ring-green-200; }
        .option-btn.incorrect { @apply border-red-500 bg-red-50 text-red-700 ring-2 ring-red-200; }
        .option-btn.disabled { @apply opacity-60 cursor-not-allowed; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen">

    <!-- Global Header -->
    <nav class="bg-indigo-700 text-white p-4 sticky top-0 z-50 shadow-lg">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <h1 class="text-xl font-bold flex items-center gap-2 cursor-pointer" onclick="showView('dashboard')">
                <i data-lucide="graduation-cap"></i> AZ-104 Exam Prep
            </h1>
            <div id="module-nav" class="hidden flex flex-wrap justify-center gap-2">
                <button onclick="showTab('notes')" class="tab-btn px-3 py-1.5 rounded-lg bg-indigo-800 hover:bg-indigo-600 transition active" data-tab="notes">Notes</button>
                <button onclick="showTab('flashcards')" class="tab-btn px-3 py-1.5 rounded-lg hover:bg-indigo-600 transition" data-tab="flashcards">Flashcards</button>
                <button onclick="showTab('quiz')" class="tab-btn px-3 py-1.5 rounded-lg hover:bg-indigo-600 transition" data-tab="quiz">Quizzes</button>
                <button onclick="showView('dashboard')" class="px-3 py-1.5 rounded-lg bg-white/10 hover:bg-white/20 transition flex items-center gap-1">
                    <i data-lucide="layout-grid" class="w-4 h-4"></i> Modules
                </button>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4 md:p-8">
        
        <!-- DASHBOARD VIEW -->
        <section id="dashboard-view" class="view-content active space-y-8">
            <header class="text-center space-y-2">
                <h2 class="text-3xl font-extrabold text-slate-800">Microsoft Certified: Azure Administrator Associate</h2>
                <p class="text-slate-500">Select an AZ-104 module to access study notes, flashcards, and practice tests.</p>
            </header>

            <div id="module-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Modules injected via JS -->
            </div>
        </section>

        <!-- UNIFIED MODULE VIEW -->
        <section id="module-view" class="view-content space-y-8">
            <div class="flex items-center gap-4 mb-2">
                <button onclick="showView('dashboard')" class="p-2 rounded-full hover:bg-slate-200 text-slate-600 transition">
                    <i data-lucide="arrow-left"></i>
                </button>
                <h2 id="current-module-title" class="text-2xl font-bold text-slate-800">Module Detail</h2>
            </div>

            <!-- NOTES TAB -->
            <div id="notes" class="tab-content active space-y-6">
                <div id="notes-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Notes injected via JS -->
                </div>
            </div>

            <!-- FLASHCARDS TAB -->
            <div id="flashcards" class="tab-content space-y-6">
                <div class="flex justify-between items-center px-2">
                    <p class="text-slate-500 text-sm italic">Click to reveal the answer.</p>
                    <button onclick="flipAllCards()" class="text-xs px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg font-bold">FLIP ALL</button>
                </div>
                <div id="flashcards-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Cards injected via JS -->
                </div>
            </div>

            <!-- QUIZ TAB -->
            <div id="quiz" class="tab-content space-y-12">
                <!-- Quiz Area 1 (Injected via JS) -->
                <div id="quiz-zone-0" class="quiz-zone space-y-4"></div>
                
                <!-- Quiz Area 2 (Injected via JS) -->
                <div id="quiz-zone-1" class="quiz-zone space-y-4"></div>
            </div>
        </section>

    </main>

    <footer class="mt-20 p-8 border-t border-slate-200 text-center text-slate-400 text-sm">
        <p>AZ-104 Exam Preparation Hub &copy; 2026</p>
    </footer>

    <script>
        const modules = [
            { id: 1, name: "Prerequisites for Azure administrators", desc: "Initial tools: Azure portal, Cloud Shell, Azure PowerShell, CLI, and ARM templates.", icon: "wrench", color: "blue" },
            { id: 2, name: "Manage identities", desc: "Microsoft Entra users and groups, managing external users, and configuring SSPR.", icon: "users", color: "indigo" },
            { id: 3, name: "Governance in Azure", desc: "implementing Azure roles, applying Azure policy, and governance controls.", icon: "shield-check", color: "purple" },
            { id: 4, name: "Implement and manage storage", desc: "Access keys, SAS tokens, Azure files, and blob storage implementation.", icon: "database", color: "cyan" },
            { id: 5, name: "Deploy and manage compute resources", desc: "Virtual Machines, App Services, and Container solutions.", icon: "cpu", color: "orange" },
            { id: 6, name: "Configure and manage virtual networks", desc: "VNETs, securing access with NSGs, load balancing, and hybrid connectivity.", icon: "share-2", color: "emerald" },
            { id: 7, name: "Monitor and back up resources", desc: "Azure Monitor, Log Analytics, alerts, and backup solutions.", icon: "activity", color: "rose" }
        ];

        const contentData = {
            3: {
                notes: [{ title: "Governance Basics", items: ["MG tree max 6 levels.", "Subscriptions: Billing unit.", "PIM: Just-in-time access.", "Activity Log: 90 days."] }],
                flashcards: [{ q: "PIM", a: "Privileged Identity Management." }],
                quizzes: [{ title: "Governance Knowledge Check", questions: [
                    { q: "Which component protects against a datacenter failure?", options: ["Regions", "Availability Zones", "Subscriptions", "Resource Groups"], correct: 1, explanation: "Availability Zones are physically separate locations within an Azure region." }
                ]}]
            },
            4: {
                notes: [{ title: "Storage Basics", items: ["LRS: 3 copies 1 DC.", "ZRS: 3 copies 3 Zones.", "Lifecycle: Auto-tiering."] }],
                flashcards: [{ q: "LRS", a: "Locally Redundant Storage." }],
                quizzes: [{ title: "Storage Solutions Quiz", questions: [
                    { q: "What is the minimum copies in LRS?", options: ["1", "2", "3", "6"], correct: 2, explanation: "LRS maintains 3 copies within one datacenter." }
                ]}]
            },
            5: {
                notes: [
                    { title: "Azure VM Availability", items: ["Availability Sets: Protects against hardware failure (Fault Domains) and maintenance (Update Domains).", "Availability Zones: Protects against entire datacenter failure within a region.", "SLA: 99.99% for VMs in 2+ Zones; 99.95% for VMs in AV Sets."] },
                    { title: "App Services & Containers", items: ["App Service Plan: Defines the set of compute resources for a web app to run.", "ACI Container Groups: Resources shared by a collection of containers.", "Container Apps: Serverless containers built on K8s and KEDA."] }
                ],
                flashcards: [
                    { q: "Fault Domain", a: "Group of VMs sharing common power and network switch." },
                    { q: "KEDA", a: "Kubernetes-based Event Driven Autoscaling, used in Container Apps." }
                ],
                quizzes: [
                    { 
                        title: "Quiz 1: Virtual Machine Architecture", 
                        questions: [
                            { q: "You need to ensure that virtual machines in a set are not all rebooted at the same time during planned Azure maintenance. What should you configure?", options: ["Fault Domains", "Update Domains", "Availability Zones", "Scale Sets"], correct: 1, explanation: "Update domains are used to ensure that only a portion of your VMs are rebooted at any given time during a planned maintenance event." },
                            { q: "Which compute sizing strategy involves changing the size of a single virtual machine to provide more CPU and RAM?", options: ["Horizontal Scaling", "Vertical Scaling", "Load Balancing", "Autoscaling"], correct: 1, explanation: "Vertical scaling (Scaling Up) involves moving the VM to a larger size, which typically requires a reboot." },
                            { q: "Which feature provides protection against a localized hardware failure (such as a power supply or network switch) within a single datacenter?", options: ["Fault Domains", "Update Domains", "Regional Pairs", "Vertical Scaling"], correct: 0, explanation: "Fault domains group VMs that share a common power source and network switch." },
                            { q: "What is the maximum number of Fault Domains you can typically configure in an Azure Availability Set?", options: ["2", "3", "5", "20"], correct: 1, explanation: "In most regions, you can configure up to 3 Fault Domains." },
                            { q: "You need to achieve a 99.99% availability SLA for your virtual machines. How should you deploy them?", options: ["Single instance with Premium SSD", "Two or more instances in an Availability Set", "Two or more instances across different Availability Zones", "Two or more instances in different Regions"], correct: 2, explanation: "99.99% SLA requires deployment across two or more Availability Zones in the same region." },
                            { q: "What is the primary benefit of using Virtual Machine Scale Sets (VMSS)?", options: ["Highest single-instance SLA", "Automatic horizontal scaling based on demand", "Manual resizing of disks", "Shared storage between instances"], correct: 1, explanation: "VMSS allows you to deploy and manage a group of identical, load-balanced VMs that scale horizontally." },
                            { q: "A company wants to run a non-critical background task that can be interrupted at any time. Which VM type offers the lowest cost for this scenario?", options: ["Reserved Instances", "Spot VMs", "Pay-as-you-go", "B-series Burstable"], correct: 1, explanation: "Spot VMs allow you to use unused capacity at a significant discount." },
                            { q: "Which Azure disk type is the best choice for sub-millisecond latency and high-performance database workloads?", options: ["Standard HDD", "Standard SSD", "Premium SSD", "Ultra Disk"], correct: 3, explanation: "Ultra Disks provide the highest performance (up to 160k IOPS) and sub-millisecond latency." },
                            { q: "When using Azure Bastion to connect to a VM, which port is typically opened on the VM's Network Security Group (NSG)?", options: ["TCP 3389", "TCP 22", "TCP 443", "No public ports are needed"], correct: 3, explanation: "Azure Bastion allows secure RDP/SSH access without needing to expose public IP addresses." },
                            { q: "You deploy a VMSS with 5 instances. You want to ensure that instances are updated one by one during a scale-set update. Which upgrade policy should you use?", options: ["Manual", "Automatic", "Rolling", "Scheduled"], correct: 2, explanation: "The Rolling upgrade policy updates the instances in batches, ensuring availability." },
                            { q: "Which VM series is specifically designed for 'burstable' workloads?", options: ["D-Series", "F-Series", "B-Series", "M-Series"], correct: 2, explanation: "The B-Series (Burstable) is cost-effective for workloads that typically run at a low baseline CPU performance." },
                            { q: "Which feature allows you to run your VMs on physical servers dedicated to your organization?", options: ["Azure Bastion", "Azure Dedicated Host", "Proximity Placement Groups", "Availability Zones"], correct: 1, explanation: "Azure Dedicated Host provides a physical server dedicated to one Azure subscription." },
                            { q: "What happens to data stored on the temporary 'D:' drive of an Azure VM when the VM is stopped and deallocated?", options: ["Data is persisted", "Data is lost", "Data is moved to a Snapshot", "Data is encrypted"], correct: 1, explanation: "The temporary drive is hosted on the physical host's local storage and lost upon deallocation." },
                            { q: "Which tool allows you to automate post-deployment tasks like installing software inside a VM?", options: ["Resource Groups", "VM Extensions", "NSGs", "Azure Policy"], correct: 1, explanation: "VM Extensions (like the Custom Script Extension) provide post-deployment automation." },
                            { q: "A Proximity Placement Group is used to achieve which goal?", options: ["High Availability", "Disaster Recovery", "Lowest possible network latency between VMs", "Compliance with data residency"], correct: 2, explanation: "Proximity Placement Groups ensure resources are physically located close to each other." },
                            { q: "When resizing a VM, what is the most common reason for receiving an 'Allocation Failed' error?", options: ["Wrong subscription", "No disk space", "The current hardware cluster doesn't support the new size", "Billing limit reached"], correct: 2, explanation: "Resizing requires moving the VM; if the cluster doesn't support the size, you must deallocate first." },
                            { q: "What is the maximum number of Update Domains in an Availability Set?", options: ["3", "5", "10", "20"], correct: 3, explanation: "You can configure up to 20 Update Domains." },
                            { q: "You need to capture a template of a configured VM to deploy identical copies. What must you do first inside the VM?", options: ["Install Azure CLI", "Run Sysprep (Windows) or waagent -deprovision (Linux)", "Create a Snapshot", "Resize the VM"], correct: 1, explanation: "You must generalize the OS first to remove instance-specific information." },
                            { q: "Which encryption method is used to encrypt the OS and Data disks using BitLocker or DM-Crypt?", options: ["SSE", "Azure Disk Encryption (ADE)", "VPN", "HTTPS"], correct: 1, explanation: "ADE uses BitLocker/DM-Crypt and integrates with Azure Key Vault." },
                            { q: "Which VM state indicates that compute charges have stopped?", options: ["Stopped", "Suspended", "Stopped (Deallocated)", "Shutting Down"], correct: 2, explanation: "Only 'Stopped (Deallocated)' releases the VM from the physical host and stops compute billing." }
                        ]
                    },
                    { 
                        title: "Quiz 2: App Services & Container Solutions", 
                        questions: [
                            { q: "What defines the compute resources, pricing tier, and region for an Azure Web App?", options: ["Resource Group", "App Service Plan", "Deployment Slot", "Traffic Manager"], correct: 1, explanation: "An App Service Plan represents a set of compute resources that a web app runs on." },
                            { q: "Which App Service Plan pricing tier is the minimum required to use Deployment Slots?", options: ["Basic", "Standard", "Premium", "Isolated"], correct: 1, explanation: "The Standard tier is the minimum level required to support deployment slots." },
                            { q: "You want to test a new version of your web app with 10% of your production traffic. Which feature should you use?", options: ["Traffic Manager", "Deployment Slots (Testing in production)", "App Service Plan Scaling", "WebJobs"], correct: 1, explanation: "Deployment slots allow you to route a specific percentage of traffic to a non-production slot for testing." },
                            { q: "In Azure App Service, what happens when you perform a 'Swap' operation between a staging slot and the production slot?", options: ["The code is copied", "IP addresses are updated in DNS", "The virtual machine is restarted", "The configuration and content are exchanged between slots"], correct: 3, explanation: "A swap exchanges the source and target slots' configurations and content, usually with zero downtime." },
                            { q: "Which scaling method in App Service involves adding more CPU, Memory, or Disk space to the existing instances?", options: ["Scale Out", "Scale Up", "Autoscale", "Manual Scale"], correct: 1, explanation: "Scaling up (Vertical Scaling) involves moving to a higher pricing tier with more resources per instance." },
                            { q: "Azure App Service Autoscale can be triggered by which of the following?", options: ["CPU Percentage", "Memory Percentage", "Schedule (Recurring)", "All of the above"], correct: 3, explanation: "Autoscale rules can be based on metrics (CPU/RAM) or specific schedules." },
                            { q: "What is a 'Container Group' in Azure Container Instances (ACI)?", options: ["A collection of ACI instances in different regions", "A collection of containers that are scheduled on the same host machine and share a lifecycle", "A Kubernetes namespace", "A Docker Swarm"], correct: 1, explanation: "A container group is the top-level resource in ACI. Containers in a group share a lifecycle, resources, local network, and storage volumes." },
                            { q: "You need to run a simple containerized task that completes in minutes. You want to avoid managing servers or orchestrators. Which service is best?", options: ["AKS", "ACI", "VMSS", "Azure App Service"], correct: 1, explanation: "Azure Container Instances (ACI) is the fastest and simplest way to run a container in Azure without managing any virtual machines." },
                            { q: "Which restart policy is the default for Azure Container Instances?", options: ["Always", "Never", "OnFailure", "RestartAlways"], correct: 0, explanation: "By default, ACI uses the 'Always' restart policy for container groups." },
                            { q: "What is the 'AKS Virtual Node' add-on used for?", options: ["Adding more physical servers to AKS", "Deploying serverless containers to ACI from AKS", "Upgrading the Kubernetes version", "Managing Windows nodes"], correct: 1, explanation: "Virtual Nodes allow AKS to quickly scale out into serverless containers running in ACI to handle traffic bursts." },
                            { q: "Azure Container Apps is built on top of which underlying technologies?", options: ["Docker Swarm and Nginx", "Kubernetes, KEDA, Dapr, and Envoy", "VMSS and Azure Load Balancer", "Service Fabric"], correct: 1, explanation: "Azure Container Apps is a serverless platform built on Kubernetes, utilizing KEDA for scaling and Dapr for microservices." },
                            { q: "What is KEDA in the context of Azure Container Apps?", options: ["A deployment tool", "Kubernetes-based Event Driven Autoscaling", "A networking protocol", "An encryption service"], correct: 1, explanation: "KEDA allows Container Apps to scale based on events like message queue depth or HTTP traffic." },
                            { q: "How does Azure Container Apps differ from AKS regarding cluster management?", options: ["Both require manual node patching", "Container Apps abstracts away the Kubernetes control plane and nodes", "AKS is serverless while Container Apps is not", "There is no difference"], correct: 1, explanation: "Container Apps is serverless and managed; users don't manage the underlying Kubernetes cluster or nodes." },
                            { q: "You need to run multiple versions of a containerized application in Azure Container Apps simultaneously. What is this concept called?", options: ["Slots", "Revisions", "Nodes", "Deployments"], correct: 1, explanation: "In Container Apps, 'Revisions' are immutable snapshots of your application that allow for multiple versions to run." },
                            { q: "Which component in Azure Container Apps provides a consistent set of APIs for microservices like service discovery and state management?", options: ["KEDA", "Dapr", "Envoy", "Azure Policy"], correct: 1, explanation: "Dapr (Distributed Application Runtime) is integrated into Container Apps to simplify building distributed systems." },
                            { q: "A 'Consumption' plan in Azure Container Apps charges you based on what?", options: ["Hourly reservation", "Per-second resource allocation (vCPU and Memory) and total requests", "Fixed monthly fee", "Number of containers"], correct: 1, explanation: "The Consumption plan is purely serverless, charging based on active usage per second." },
                            { q: "What is the primary protocol used by Azure File Sync to communicate with on-premises servers?", options: ["SMB", "HTTPS", "FTP", "NFS"], correct: 1, explanation: "Azure File Sync communicates with the cloud service over port 443 (HTTPS)." },
                            { q: "In App Service, where should you store sensitive information like database connection strings?", options: ["In the app's web.config", "In the Application Settings / Connection Strings section of the portal", "In a public Git repository", "In a local text file on the VM"], correct: 1, explanation: "Connection Strings in the portal are encrypted at rest and injected into the app at runtime, making them secure." },
                            { q: "Can an App Service Plan host multiple web apps?", options: ["No, one app per plan", "Yes, all apps in the plan share the compute resources", "Yes, but they must be in different regions", "Only in the Premium tier"], correct: 1, explanation: "Multiple apps can share one plan, which helps optimize costs by consolidating workloads onto the same compute resources." },
                            { q: "Which ACI feature allows containers to share a local network and storage volumes?", options: ["Container Groups", "Virtual Networks", "Resource Groups", "Azure Files"], correct: 0, explanation: "Container Groups are the logical boundary in ACI that allows multi-container scenarios where containers share the same environment." }
                        ]
                    }
                ]
            }
        };

        let currentModuleId = null;
        let activeQuizStates = []; // Track state for multiple quizzes

        function showView(viewId) {
            document.querySelectorAll('.view-content').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId + '-view').classList.add('active');
            const nav = document.getElementById('module-nav');
            if(viewId === 'dashboard') { nav.classList.add('hidden'); currentModuleId = null; }
            else nav.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('bg-indigo-800', 'text-white'));
            document.getElementById(tabId).classList.add('active');
            const btn = document.querySelector(`[data-tab="${tabId}"]`);
            if(btn) btn.classList.add('bg-indigo-800', 'text-white');
        }

        function openModule(id) {
            currentModuleId = id;
            const module = modules.find(m => m.id == id);
            document.getElementById('current-module-title').innerText = `AZ-104: ${module.name}`;
            loadModuleContent(id);
            showView('module');
            showTab('notes');
        }

        function loadModuleContent(id) {
            const data = contentData[id] || { 
                notes: [{ title: "Under Development", items: ["Study material coming soon."] }],
                flashcards: [{ q: "Ready?", a: "Stay tuned." }],
                quizzes: [{ title: "Coming Soon", questions: [] }]
            };

            // Notes
            document.getElementById('notes-container').innerHTML = data.notes.map(note => `
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                    <h4 class="font-bold text-slate-800 mb-3">${note.title}</h4>
                    <ul class="space-y-2 text-sm text-slate-600">${note.items.map(i => `<li>â€¢ ${i}</li>`).join('')}</ul>
                </div>
            `).join('');

            // Flashcards
            document.getElementById('flashcards-grid').innerHTML = data.flashcards.map((c, i) => `
                <div class="flashcard-container" id="fc-${i}" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front bg-indigo-600 text-white font-bold text-sm px-4">${c.q}</div>
                        <div class="flashcard-back bg-white border-2 border-indigo-600 text-indigo-900 text-xs font-medium px-4">${c.a}</div>
                    </div>
                </div>
            `).join('');

            // Quizzes
            activeQuizStates = data.quizzes.map(() => ({ idx: 0, score: 0, attempted: 0, isAnswering: true }));
            renderQuizZones(data.quizzes);
            lucide.createIcons();
        }

        function renderQuizZones(quizzes) {
            const zones = [document.getElementById('quiz-zone-0'), document.getElementById('quiz-zone-1')];
            zones.forEach(z => z.innerHTML = ''); // Clear
            
            quizzes.forEach((q, i) => {
                const zone = zones[i];
                if (!zone) return;

                zone.innerHTML = `
                    <div id="quiz-start-${i}" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 text-center space-y-4">
                        <i data-lucide="zap" class="mx-auto w-12 h-12 text-yellow-500"></i>
                        <h2 class="text-xl font-bold">${q.title}</h2>
                        <p class="text-slate-500 text-sm">${q.questions.length} Exam-style Questions</p>
                        <button onclick="startQuiz(${i})" class="px-8 py-3 rounded-xl bg-indigo-700 text-white font-bold">Start This Quiz</button>
                    </div>

                    <div id="quiz-container-${i}" class="hidden grid md:grid-cols-3 gap-6">
                        <div class="md:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col items-center h-fit">
                            <div class="relative w-32 h-32 mb-4">
                                <svg viewBox="0 0 120 120" class="w-full h-full">
                                    <circle cx="60" cy="60" r="50" fill="none" stroke="#f1f5f9" stroke-width="8" />
                                    <circle cx="60" cy="60" r="38" fill="none" stroke="#f1f5f9" stroke-width="8" />
                                    <circle id="ring-attempted-${i}" cx="60" cy="60" r="50" fill="none" stroke="#6366f1" stroke-width="8" stroke-linecap="round" class="donut-ring" stroke-dasharray="314" stroke-dashoffset="314" />
                                    <circle id="ring-correct-${i}" cx="60" cy="60" r="38" fill="none" stroke="#22c55e" stroke-width="8" stroke-linecap="round" class="donut-ring" stroke-dasharray="239" stroke-dashoffset="239" />
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center text-lg font-bold" id="accuracy-text-${i}">0%</div>
                            </div>
                            <div class="w-full text-sm space-y-1">
                                <div class="flex justify-between"><span>Attempted:</span> <span id="stat-attempted-${i}" class="font-bold">0/0</span></div>
                                <div class="flex justify-between text-green-600"><span>Correct:</span> <span id="stat-correct-${i}" class="font-bold">0</span></div>
                            </div>
                        </div>
                        <div class="md:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                            <div class="text-indigo-600 font-bold mb-2 text-sm" id="quiz-progress-text-${i}">Question 1/0</div>
                            <h3 class="text-lg font-bold mb-6" id="quiz-question-${i}">Loading...</h3>
                            <div class="grid gap-2" id="quiz-options-${i}"></div>
                            <div id="quiz-feedback-${i}" class="hidden mt-6 p-4 rounded-xl border animate-in fade-in duration-300">
                                <div class="flex items-center gap-2 mb-2">
                                    <i id="feedback-icon-${i}" class="w-5 h-5"></i>
                                    <span id="feedback-title-${i}" class="font-bold">Explanation</span>
                                </div>
                                <p id="feedback-text-${i}" class="text-sm text-slate-600 leading-relaxed"></p>
                                <button onclick="nextQuestion(${i})" class="mt-4 w-full py-2 bg-indigo-700 text-white rounded-lg font-bold hover:bg-indigo-800 transition">Next Question</button>
                            </div>
                        </div>
                    </div>

                    <div id="quiz-result-${i}" class="hidden bg-white p-8 rounded-2xl shadow-sm border border-slate-200 text-center space-y-4">
                        <h2 class="text-2xl font-bold">Module Result</h2>
                        <div class="text-5xl font-bold text-indigo-700" id="quiz-score-${i}">0/0</div>
                        <button onclick="resetQuiz(${i})" class="px-6 py-2 rounded-lg bg-indigo-700 text-white font-bold">Restart Test</button>
                    </div>
                `;
            });
        }

        // Multiple Quiz Logic
        function startQuiz(qIdx) {
            document.getElementById(`quiz-start-${qIdx}`).classList.add('hidden');
            document.getElementById(`quiz-container-${qIdx}`).classList.remove('hidden');
            activeQuizStates[qIdx] = { idx: 0, score: 0, attempted: 0, isAnswering: true };
            updateDonut(qIdx);
            showQuestion(qIdx);
        }

        function showQuestion(qIdx) {
            const state = activeQuizStates[qIdx];
            const quizData = contentData[currentModuleId].quizzes[qIdx];
            const curr = quizData.questions[state.idx];
            state.isAnswering = true;

            document.getElementById(`quiz-progress-text-${qIdx}`).innerText = `Question ${state.idx + 1}/${quizData.questions.length}`;
            document.getElementById(`quiz-question-${qIdx}`).innerText = curr.q;
            document.getElementById(`quiz-feedback-${qIdx}`).classList.add('hidden');
            
            const optionsDiv = document.getElementById(`quiz-options-${qIdx}`);
            optionsDiv.innerHTML = '';
            curr.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = `opt-btn-${qIdx} w-full text-left p-3 rounded-lg border border-slate-200 hover:bg-indigo-50 text-sm font-medium transition flex justify-between items-center`;
                btn.innerHTML = `<span>${opt}</span><i class="hidden w-4 h-4"></i>`;
                btn.onclick = () => selectOption(qIdx, i, btn);
                optionsDiv.appendChild(btn);
            });
            lucide.createIcons();
        }

        function selectOption(qIdx, optI, btn) {
            const state = activeQuizStates[qIdx];
            if (!state.isAnswering) return;
            state.isAnswering = false;
            
            const quizData = contentData[currentModuleId].quizzes[qIdx];
            const curr = quizData.questions[state.idx];
            const isCorrect = optI === curr.correct;
            
            state.attempted++;
            if(isCorrect) state.score++;

            const btns = document.querySelectorAll(`.opt-btn-${qIdx}`);
            btns.forEach((b, idx) => {
                b.classList.add('disabled');
                if (idx === curr.correct) {
                    b.classList.add('correct');
                    b.querySelector('i').classList.remove('hidden');
                    b.querySelector('i').setAttribute('data-lucide', 'check');
                } else if (idx === optI && !isCorrect) {
                    b.classList.add('incorrect');
                    b.querySelector('i').classList.remove('hidden');
                    b.querySelector('i').setAttribute('data-lucide', 'x');
                }
            });

            const feedback = document.getElementById(`quiz-feedback-${qIdx}`);
            feedback.classList.remove('hidden');
            document.getElementById(`feedback-title-${qIdx}`).innerText = isCorrect ? "Correct!" : "Incorrect";
            document.getElementById(`feedback-text-${qIdx}`).innerText = curr.explanation;
            feedback.className = `mt-6 p-4 rounded-xl border ${isCorrect ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'}`;
            
            lucide.createIcons();
            updateDonut(qIdx);
        }

        function nextQuestion(qIdx) {
            const state = activeQuizStates[qIdx];
            const quizData = contentData[currentModuleId].quizzes[qIdx];
            state.idx++;
            if(state.idx < quizData.questions.length) showQuestion(qIdx);
            else showQuizResult(qIdx);
        }

        function updateDonut(qIdx) {
            const state = activeQuizStates[qIdx];
            const total = contentData[currentModuleId].quizzes[qIdx].questions.length;
            const outer = 314, inner = 239;
            
            document.getElementById(`ring-attempted-${qIdx}`).style.strokeDashoffset = outer - (state.attempted/total)*outer;
            document.getElementById(`ring-correct-${qIdx}`).style.strokeDashoffset = inner - (state.score/total)*inner;
            document.getElementById(`stat-attempted-${qIdx}`).innerText = `${state.attempted}/${total}`;
            document.getElementById(`stat-correct-${qIdx}`).innerText = state.score;
            document.getElementById(`accuracy-text-${qIdx}`).innerText = state.attempted ? Math.round((state.score/state.attempted)*100)+"%" : "0%";
        }

        function showQuizResult(qIdx) {
            const state = activeQuizStates[qIdx];
            const total = contentData[currentModuleId].quizzes[qIdx].questions.length;
            document.getElementById(`quiz-container-${qIdx}`).classList.add('hidden');
            document.getElementById(`quiz-result-${qIdx}`).classList.remove('hidden');
            document.getElementById(`quiz-score-${qIdx}`).innerText = `${state.score}/${total}`;
        }

        function resetQuiz(qIdx) {
            document.getElementById(`quiz-result-${qIdx}`).classList.add('hidden');
            document.getElementById(`quiz-container-${qIdx}`).classList.add('hidden');
            document.getElementById(`quiz-start-${qIdx}`).classList.remove('hidden');
        }

        function renderModules() {
            document.getElementById('module-grid').innerHTML = modules.map(m => `
                <div onclick="openModule('${m.id}')" class="module-card bg-white p-6 rounded-2xl shadow-sm border border-slate-200 cursor-pointer hover:shadow-md transition">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4 bg-${m.color}-100 text-${m.color}-600"><i data-lucide="${m.icon}"></i></div>
                    <h3 class="font-bold text-lg mb-2">AZ-104: ${m.name}</h3>
                    <p class="text-slate-500 text-sm leading-relaxed">${m.desc}</p>
                    <div class="mt-4 flex items-center text-xs font-bold text-indigo-600 gap-1 uppercase tracking-wide">Study Domain <i data-lucide="chevron-right" class="w-3 h-3"></i></div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function flipAllCards() {
            const cards = document.querySelectorAll('.flashcard-container');
            const isAnyNotFlipped = Array.from(cards).some(c => !c.classList.contains('flipped'));
            cards.forEach(c => isAnyNotFlipped ? c.classList.add('flipped') : c.classList.remove('flipped'));
        }

        window.onload = () => { renderModules(); };
    </script>
</body>
</html>
